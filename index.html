<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Daggerheart Character Sheets</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <main class="container">
    <h1>Daggerheart Character Sheets</h1>

    <section class="card">
      <h2>Open or Create a Sheet</h2>
      <p class="small">
        Enter a <strong>Character ID</strong> and choose a page.
        Anyone who opens the same character + page sees the same data, live.
      </p>

      <label for="char-id">Character ID</label>
      <input
        id="char-id"
        type="text"
        placeholder="e.g. kael, sister-mira, gm-npc-01"
      >

      <label for="page-id">Page</label>
      <select id="page-id">
        <option value="core">Core Sheet</option>
        <option value="advancement">Advancement / XP</option>
        <option value="notes">Notes</option>
      </select>

      <div class="actions">
        <button id="open-sheet">Open Sheet</button>
        <button class="secondary" id="quick-test">Open Test Sheet</button>
      </div>

      <p class="small">
        Sheets are stored in Firebase under
        <code>characters/{charId}/pages/{pageId}</code>.
      </p>
    </section>

    <section class="card">
      <h2>How This Works</h2>
      <ul class="small">
        <li>Background is a static PNG of the Daggerheart sheet.</li>
        <li>Inputs and checkboxes are absolutely positioned over the art.</li>
        <li>All edits sync in real time via Firestore.</li>
      </ul>
    </section>
  </main>

  <script>
    const charInput = document.getElementById('char-id');
    const pageSelect = document.getElementById('page-id');
    const openBtn = document.getElementById('open-sheet');
    const quickTestBtn = document.getElementById('quick-test');

    function openSheet(charId, pageId) {
      charId = (charId || '').trim();
      if (!charId) {
        alert('Enter a Character ID first.');
        return;
      }
      const url = `sheet.html?char=${encodeURIComponent(charId)}&page=${encodeURIComponent(pageId)}`;
      window.location.href = url;
    }

    openBtn.addEventListener('click', () => {
      openSheet(charInput.value, pageSelect.value);
    });

    quickTestBtn.addEventListener('click', () => {
      // Low-friction test: prefill something and go
      if (!charInput.value.trim()) {
        charInput.value = 'test-char';
      }
      if (!pageSelect.value) {
        pageSelect.value = 'core';
      }
      openSheet(charInput.value, pageSelect.value);
    });

    // Hit Enter to open
    charInput.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') {
        openSheet(charInput.value, pageSelect.value);
      }
    });
  </script>
</body>
</html>
